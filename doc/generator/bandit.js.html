<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html xmlns:yui="http://yuilibrary.com/rdf/1.0/yui.rdf#">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<title>API: BandIt   bandit.js  (YUI Library)</title>

	<link rel="stylesheet" type="text/css" href="assets/reset-fonts-grids-min.css?stamp=1336117382.39" />
	<link rel="stylesheet" type="text/css" href="assets/api.css?stamp=1336117382.39" />

    <script type="text/javascript" src="assets/api-js?stamp=1336117382.39"></script>
    <script type="text/javascript" src="assets/ac-js?stamp=1336117382.39"></script>
</head>

<body id="yahoo-com">

<div id="doc3" class="yui-t2">
	<div id="hd">
        <h1><a href="http://developer.yahoo.com/yui/" title="BandIt">BandIt</a></h1>
        <h3>BandIt&nbsp; <span class="subtitle">0.1.0</span></h3>
        <a href="./index.html" title="BandIt">BandIt</a> 
            &gt; <a href="./module_bandit.html" title="BandIt">BandIt</a>
                
                 &gt; bandit.js (source view) 
        <form onsubmit="return false">
            <div id="propertysearch">
                Search: <input autocomplete="off" id="searchinput" />
                <div id="searchresults">
                    &nbsp;
                </div>
            </div>
        </form>
	</div>

	<div id="bd">
		<div id="yui-main">
			<div class="yui-b">
            <form action="#" name="yui-classopts-form" method="get" id="yui-classopts-form">
                <fieldset>
                    <legend>Filters</legend>
                <span class="classopts"><input type="checkbox" name="show_private" id="show_private" /> <label for="show_private">Show Private</label></span>
                <span class="classopts"><input type="checkbox" name="show_protected" id="show_protected" /> <label for="show_protected">Show Protected</label></span>
                <span class="classopts"><input type="checkbox" name="show_deprecated" id="show_deprecated" /> <label for="show_deprecated">Show Deprecated</label></span>
                </fieldset>
            </form>

                    <div id="srcout">
                        <style>
                            #doc3 .classopts { display:none; }
                        </style>
<div class="highlight"><pre><span class="cm">/**</span>
<span class="cm"> * The BandIt module provides methods to draw a workflow&lt;br/&gt;</span>
<span class="cm"> * Author: Olivier Sallou &lt;olivier.sallou@irisa.fr&gt;&lt;/br&gt;</span>
<span class="cm"> * License: CeCILL-B</span>
<span class="cm"> * @module BandIt</span>
<span class="cm"> * @requires RaphaelJS, JQuery</span>
<span class="cm"> *</span>
<span class="cm"> */</span>



<span class="cm">/**</span>
<span class="cm"> * BandIt is a library above RaphaelJS to create workflows in HTML/JS.</span>
<span class="cm"> * @class BandIt</span>
<span class="cm"> * @constructor</span>
<span class="cm"> * @param diveditor Name of the div where editor will be put</span>
<span class="cm"> * @param width Width of the div</span>
<span class="cm"> * @param height Height of the div</span>
<span class="cm"> */</span>

<span class="kd">function</span> <span class="nx">BandIt</span><span class="p">(</span><span class="nx">diveditor</span><span class="p">,</span><span class="nx">width</span><span class="p">,</span><span class="nx">height</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">// Raphael SVG</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">paper</span> <span class="o">=</span> <span class="nx">Raphael</span><span class="p">(</span><span class="nx">diveditor</span><span class="p">,</span><span class="nx">width</span><span class="p">,</span><span class="nx">height</span><span class="p">);</span>
	<span class="cm">/**</span>
<span class="cm">	 * Operation mode:</span>
<span class="cm">	 * 0 : drag and drop, selection</span>
<span class="cm">	 * 1 : link</span>
<span class="cm">	 * 2 : delete</span>
<span class="cm">	 */</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">currentnode</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">nodes</span> <span class="o">=</span> <span class="p">{};</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">outlinks</span> <span class="o">=</span> <span class="p">{};</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">inlinks</span> <span class="o">=</span> <span class="p">{};</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">paths</span> <span class="o">=</span> <span class="p">{};</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">zoom</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="c1">// Node properties object</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">properties</span> <span class="o">=</span> <span class="p">{};</span>

	<span class="k">this</span><span class="p">.</span><span class="nx">selectCallbacks</span> <span class="o">=</span> <span class="p">[];</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">deleteCallbacks</span> <span class="o">=</span> <span class="p">[];</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">addCallbacks</span> <span class="o">=</span> <span class="p">[];</span>
<span class="p">}</span>

<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">arrow</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x1</span><span class="p">,</span> <span class="nx">y1</span><span class="p">,</span> <span class="nx">x2</span><span class="p">,</span> <span class="nx">y2</span><span class="p">,</span> <span class="nx">size</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">angle</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">atan2</span><span class="p">(</span><span class="nx">x1</span><span class="o">-</span><span class="nx">x2</span><span class="p">,</span><span class="nx">y2</span><span class="o">-</span><span class="nx">y1</span><span class="p">);</span>
    <span class="nx">angle</span> <span class="o">=</span> <span class="p">(</span><span class="nx">angle</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">))</span> <span class="o">*</span> <span class="mi">360</span><span class="p">;</span>
    <span class="nx">ax2</span> <span class="o">=</span> <span class="nx">x1</span> <span class="o">+</span> <span class="p">(</span><span class="nx">x2</span> <span class="o">-</span> <span class="nx">x1</span><span class="p">)</span> <span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="nx">ay2</span> <span class="o">=</span> <span class="nx">y1</span> <span class="o">+</span> <span class="p">(</span><span class="nx">y2</span> <span class="o">-</span> <span class="nx">y1</span><span class="p">)</span> <span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">arrowPath</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">path</span><span class="p">(</span><span class="s2">&quot;M&quot;</span> <span class="o">+</span> <span class="nx">ax2</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">ay2</span> <span class="o">+</span> <span class="s2">&quot; L&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">ax2</span> <span class="o">-</span> <span class="nx">size</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">ay2</span> <span class="o">-</span> <span class="nx">size</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; L&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">ax2</span> <span class="o">-</span> <span class="nx">size</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">ay2</span> <span class="o">+</span> <span class="nx">size</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; L&quot;</span> <span class="o">+</span> <span class="nx">ax2</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">ay2</span> <span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span><span class="s2">&quot;black&quot;</span><span class="p">).</span><span class="nx">rotate</span><span class="p">((</span><span class="mi">90</span><span class="o">+</span><span class="nx">angle</span><span class="p">),</span><span class="nx">ax2</span><span class="p">,</span><span class="nx">ay2</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">arrowPath</span><span class="p">;</span>
<span class="p">}</span>


<span class="cm">/**</span>
<span class="cm">* Register a callback when a node is selected</span>
<span class="cm">* @method registerSelect</span>
<span class="cm">* @param callback Function to use when a node is selected, function(nodeid, nodeproperties)</span>
<span class="cm">*/</span>
<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">registerSelect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">selectCallbacks</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm">* Register a callback when a node is deleted</span>
<span class="cm">* @method registerDelete</span>
<span class="cm">* @param callback Function to use when a node is deleted, function(nodeid)</span>
<span class="cm">*/</span>

<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">registerDelete</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">deleteCallbacks</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm">* Register a callback when a node is added</span>
<span class="cm">* @method registerAdd</span>
<span class="cm">* @param callback Function to use when a node is added, function(nodeid)</span>
<span class="cm">*/</span>
<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">registerAdd</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">addCallbacks</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
<span class="p">}</span>



<span class="cm">/**</span>
<span class="cm">* Gets current edition mode</span>
<span class="cm">* @method getMode</span>
<span class="cm">* @return current {int}  mode</span>
<span class="cm">*</span>
<span class="cm">*/</span>
<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getMode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">mode</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm">* Sets current edition mode</span>
<span class="cm">* @method setMode</span>
<span class="cm">* @param newmode {int}  new edition mode</span>
<span class="cm">*</span>
<span class="cm">*/</span>
<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setMode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">newmode</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">mode</span> <span class="o">=</span> <span class="nx">newmode</span><span class="p">;</span>
        <span class="nx">banditLogger</span><span class="p">.</span><span class="nx">DEBUG</span><span class="p">(</span><span class="s2">&quot;Switch to mode &quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">mode</span><span class="p">);</span>
<span class="p">}</span>


<span class="cm">/**</span>
<span class="cm">* Update the properties of a node</span>
<span class="cm">* @method setProperties</span>
<span class="cm">* @param nodeid {int} ID of the node</span>
<span class="cm">* @param props {Object} Properties of the node</span>
<span class="cm">*</span>
<span class="cm">*/</span>

<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setProperties</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">nodeid</span><span class="p">,</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">nodeid</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">props</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm">* Sets default list of properties</span>
<span class="cm">* @method setDefaultProperties</span>
<span class="cm">* @param props {Object}  Key/value pairs of properties</span>
<span class="cm">*</span>
<span class="cm">*/</span>

<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setDefaultProperties</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">properties</span> <span class="o">=</span> <span class="nx">props</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm">* get Rapahel Paper element</span>
<span class="cm">* @method getPaper</span>
<span class="cm">* @return {Paper} paper used for the draw</span>
<span class="cm">*/</span>
<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getPaper</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">paper</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm">* Creates a directed link between two nodes</span>
<span class="cm">* @method link</span>
<span class="cm">* @param startnode {int} Id of start node</span>
<span class="cm">* @param endnode {int} Id of end node</span>
<span class="cm">* @return {int} Id of the graph link</span>
<span class="cm">*/</span>
<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">link</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">startnode</span><span class="p">,</span><span class="nx">endnode</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">xpos</span> <span class="o">=</span> <span class="nx">startnode</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">startnode</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
  <span class="nx">ypos</span> <span class="o">=</span> <span class="nx">startnode</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">startnode</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
  <span class="nx">xend</span> <span class="o">=</span> <span class="nx">endnode</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">endnode</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="p">;</span>
  <span class="nx">yend</span> <span class="o">=</span> <span class="nx">endnode</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">endnode</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="p">;</span>
  <span class="nx">path</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">path</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="o">+</span><span class="nx">xpos</span><span class="o">+</span><span class="s2">&quot;,&quot;</span><span class="o">+</span><span class="nx">ypos</span><span class="o">+</span><span class="s2">&quot;L&quot;</span><span class="o">+</span><span class="nx">xend</span><span class="o">+</span><span class="s2">&quot;,&quot;</span><span class="o">+</span><span class="nx">yend</span><span class="p">);</span>
  <span class="nx">arrowpath</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">arrow</span><span class="p">(</span><span class="nx">xpos</span><span class="p">,</span><span class="nx">ypos</span><span class="p">,</span><span class="nx">xend</span><span class="p">,</span><span class="nx">yend</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
  <span class="nx">banditLogger</span><span class="p">.</span><span class="nx">DEBUG</span><span class="p">(</span><span class="s2">&quot;add arrow &quot;</span><span class="o">+</span><span class="nx">arrowpath</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">paths</span><span class="p">[</span><span class="nx">path</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span>  <span class="p">{</span> <span class="nx">arrow</span> <span class="o">:</span> <span class="nx">arrowpath</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">direction</span><span class="o">:</span> <span class="nx">endnode</span><span class="p">.</span><span class="nx">id</span> <span class="p">};</span>
  <span class="nx">mybandit</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
  <span class="nx">path</span><span class="p">.</span><span class="nx">mousedown</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">mode</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">path</span> <span class="o">=</span> <span class="nx">mybandit</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">getElementByPoint</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
      <span class="nx">mybandit</span><span class="p">.</span><span class="nx">deletepath</span><span class="p">(</span><span class="nx">path</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span>
  <span class="nx">path</span><span class="p">.</span><span class="nx">toBack</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">inlinks</span><span class="p">[</span><span class="nx">endnode</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">inlinks</span><span class="p">[</span><span class="nx">endnode</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="p">}</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">inlinks</span><span class="p">[</span><span class="nx">endnode</span><span class="p">.</span><span class="nx">id</span><span class="p">].</span><span class="nx">push</span><span class="p">({</span> <span class="nx">path</span> <span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">node</span> <span class="o">:</span> <span class="nx">startnode</span><span class="p">.</span><span class="nx">id</span> <span class="p">});</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">outlinks</span><span class="p">[</span><span class="nx">startnode</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span> 
    <span class="k">this</span><span class="p">.</span><span class="nx">outlinks</span><span class="p">[</span><span class="nx">startnode</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="p">}</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">outlinks</span><span class="p">[</span><span class="nx">startnode</span><span class="p">.</span><span class="nx">id</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span> <span class="p">{</span> <span class="nx">path</span> <span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">node</span> <span class="o">:</span> <span class="nx">endnode</span><span class="p">.</span><span class="nx">id</span> <span class="p">});</span>
  <span class="k">return</span> <span class="nx">path</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm">* Adds a new node on paper</span>
<span class="cm">* @method addnode</span>
<span class="cm">* @param name {string}  Unique name of the node (optional). If undefined, a default counter is used</span>
<span class="cm">* @param atts {Object}  Element properties (optional). For properties, look at Raphael Element documentation.</span>
<span class="cm">* @return {Node} Node element</span>
<span class="cm">*</span>
<span class="cm">*/</span>

<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">add</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="nx">attrs</span><span class="p">)</span> <span class="p">{</span>
	<span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">rect</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">zoom</span><span class="p">,</span><span class="mi">60</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">zoom</span><span class="p">);</span>
        <span class="nx">nodeattr</span> <span class="o">=</span> <span class="nx">pick</span><span class="p">(</span><span class="nx">attrs</span><span class="p">,{</span> <span class="nx">fill</span> <span class="o">:</span> <span class="s2">&quot;#f00&quot;</span> <span class="p">});</span>
        <span class="nx">node</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="nx">nodeattr</span><span class="p">);</span>

	<span class="k">this</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">p</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">properties</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="nx">p</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">properties</span><span class="p">[</span><span class="nx">p</span><span class="p">];</span>
        <span class="p">}</span>

	<span class="nx">xpos</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
	<span class="nx">ypos</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>

        <span class="nx">nodename</span> <span class="o">=</span> <span class="nx">pick</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="s2">&quot;node&quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">count</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">count</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>

	<span class="kd">var</span> <span class="nx">nodetext</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">xpos</span><span class="p">,</span><span class="nx">ypos</span><span class="p">,</span><span class="nx">nodename</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span><span class="s2">&quot;#FBFBEF&quot;</span><span class="p">);</span>
	<span class="nx">nodetext</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;font-size&quot;</span><span class="p">,</span><span class="mi">16</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">zoom</span><span class="p">);</span>
	<span class="nx">nodetext</span><span class="p">.</span><span class="nx">toFront</span><span class="p">();</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">][</span><span class="s2">&quot;child&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">][</span><span class="s2">&quot;child&quot;</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">]</span><span class="o">=</span><span class="nx">nodetext</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">=</span><span class="nx">nodename</span><span class="p">;</span>

	<span class="kd">var</span> <span class="nx">mybandit</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

	<span class="nx">node</span><span class="p">.</span><span class="nx">mousedown</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
			<span class="nx">node</span> <span class="o">=</span> <span class="nx">mybandit</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">getElementByPoint</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
			<span class="nx">currentnode</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">id</span>
			<span class="nx">banditLogger</span><span class="p">.</span><span class="nx">DEBUG</span><span class="p">(</span><span class="s2">&quot;mode: &quot;</span><span class="o">+</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">mode</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">mode</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
			<span class="c1">// Link mode , nothing to do</span>
			<span class="k">return</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">mode</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
			<span class="c1">// Delete mode, delete node</span>
			<span class="nx">mybandit</span><span class="p">.</span><span class="nx">deletenode</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
			<span class="k">return</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="p">(</span><span class="s2">&quot;node &quot;</span><span class="o">+</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="o">+</span><span class="s2">&quot; selected&quot;</span><span class="p">);</span>
                        <span class="c1">// callbacks</span>
                        <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">mybandit</span><span class="p">.</span><span class="nx">selectCallbacks</span><span class="p">)</span> <span class="p">{</span>
                           <span class="nx">mybandit</span><span class="p">.</span><span class="nx">selectCallbacks</span><span class="p">[</span><span class="nx">i</span><span class="p">](</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">]);</span>
                        <span class="p">}</span>
			<span class="p">});</span>

	<span class="nx">node</span><span class="p">.</span><span class="nx">mouseup</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">mode</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span><span class="p">;</span> 
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">mode</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
			<span class="nx">node</span> <span class="o">=</span> <span class="nx">mybandit</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">getElementByPoint</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
			<span class="k">if</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span> <span class="o">==</span> <span class="nx">currentnode</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span><span class="p">;</span> <span class="c1">// Do not link same node</span>
			<span class="p">}</span>
			<span class="nx">startnode</span> <span class="o">=</span> <span class="nx">mybandit</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">getById</span><span class="p">(</span><span class="nx">currentnode</span><span class="p">);</span>
			<span class="nx">mybandit</span><span class="p">.</span><span class="nx">link</span><span class="p">(</span><span class="nx">startnode</span><span class="p">,</span> <span class="nx">node</span><span class="p">);</span>
			<span class="p">}</span>
	<span class="p">});</span>

	<span class="kd">var</span> <span class="nx">start</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">mode</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">this</span><span class="p">.</span><span class="nx">ox</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">);</span>
		<span class="k">this</span><span class="p">.</span><span class="nx">oy</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">);</span>
		<span class="k">this</span><span class="p">.</span><span class="nx">animate</span><span class="p">({</span> <span class="nx">opacity</span><span class="o">:</span> <span class="p">.</span><span class="mi">25</span><span class="p">},</span> <span class="mi">500</span><span class="p">,</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">);</span> 
	<span class="p">};</span>
	<span class="kd">var</span> <span class="nx">move</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">dx</span><span class="p">,</span> <span class="nx">dy</span><span class="p">,</span><span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">mode</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">||</span> <span class="nx">mybandit</span><span class="p">.</span><span class="nx">mode</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
		<span class="p">}</span>
		<span class="k">else</span> <span class="p">{</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">attr</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">ox</span> <span class="o">+</span> <span class="nx">dx</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">oy</span> <span class="o">+</span> <span class="nx">dy</span><span class="p">});</span>
			<span class="nx">xpos</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">ox</span> <span class="o">+</span> <span class="nx">dx</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
			<span class="nx">ypos</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">oy</span> <span class="o">+</span> <span class="nx">dy</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
			<span class="nx">mybandit</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">getById</span><span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="p">][</span><span class="s2">&quot;child&quot;</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">]).</span><span class="nx">attr</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span> <span class="nx">xpos</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">ypos</span><span class="p">});</span>
			<span class="nx">mybandit</span><span class="p">.</span><span class="nx">redrawpaths</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">};</span>
	<span class="kd">var</span> <span class="nx">up</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">mode</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">this</span><span class="p">.</span><span class="nx">animate</span><span class="p">({</span> <span class="nx">opacity</span><span class="o">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">500</span><span class="p">,</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">);</span>
	<span class="p">};</span>

	<span class="nx">node</span><span class="p">.</span><span class="nx">drag</span><span class="p">(</span><span class="nx">move</span><span class="p">,</span><span class="nx">start</span><span class="p">,</span><span class="nx">up</span><span class="p">);</span>

       <span class="c1">// callbacks</span>
      <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">mybandit</span><span class="p">.</span><span class="nx">addCallbacks</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">mybandit</span><span class="p">.</span><span class="nx">addCallbacks</span><span class="p">[</span><span class="nx">i</span><span class="p">](</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
      <span class="p">}</span>

	<span class="k">return</span> <span class="nx">node</span><span class="p">;</span>

<span class="p">}</span> <span class="c1">// end addnode</span>



<span class="c1">// Redraw all path linked to current dragged node</span>
<span class="cm">/**</span>
<span class="cm">* Redraw all paths linked to a node</span>
<span class="cm">* @method redrawpaths</span>
<span class="cm">* @param nodeid {int}  Id of the Node</span>
<span class="cm">*</span>
<span class="cm">*/</span>

<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">redrawpaths</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">nodeid</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">getById</span><span class="p">(</span><span class="nx">nodeid</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">node</span> <span class="o">==</span> <span class="kc">null</span> <span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">outlinks</span><span class="p">[</span><span class="nx">nodeid</span><span class="p">]</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="k">this</span><span class="p">.</span><span class="nx">outlinks</span><span class="p">[</span><span class="nx">nodeid</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">redrawpath</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">outlinks</span><span class="p">[</span><span class="nx">nodeid</span><span class="p">][</span><span class="nx">i</span><span class="p">],</span> <span class="nx">node</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">inlinks</span><span class="p">[</span><span class="nx">nodeid</span><span class="p">]</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="k">this</span><span class="p">.</span><span class="nx">inlinks</span><span class="p">[</span><span class="nx">nodeid</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">redrawpath</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">inlinks</span><span class="p">[</span><span class="nx">nodeid</span><span class="p">][</span><span class="nx">i</span><span class="p">],</span><span class="nx">node</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span> <span class="c1">// end redrawpaths</span>

<span class="cm">/**</span>
<span class="cm">* Delete a node</span>
<span class="cm">* @method deletenode</span>
<span class="cm">* @param nodeid {int} Node id to delete</span>
<span class="cm">*</span>
<span class="cm">*/</span>

<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">deletenode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">nodeid</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">getById</span><span class="p">(</span><span class="nx">nodeid</span><span class="p">);</span>
	<span class="nx">banditLogger</span><span class="p">.</span><span class="nx">DEBUG</span><span class="p">(</span><span class="s2">&quot;delete node &quot;</span><span class="o">+</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
        <span class="c1">// callbacks</span>
        <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">deleteCallbacks</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">deleteCallbacks</span><span class="p">[</span><span class="nx">i</span><span class="p">](</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
        <span class="p">}</span>

	<span class="nx">paths</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">outlinks</span><span class="p">[</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">];</span>
	<span class="c1">// Delete text</span>
	<span class="nx">text</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">getById</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">][</span><span class="s2">&quot;child&quot;</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">]);</span>
	<span class="k">if</span><span class="p">(</span><span class="nx">text</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">text</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
	<span class="p">}</span>
	<span class="c1">// Remove paths linked to node, if any</span>
	<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">paths</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="nx">paths</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
			<span class="kd">var</span> <span class="nx">pathobject</span> <span class="o">=</span>  <span class="k">this</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">getById</span><span class="p">(</span><span class="nx">paths</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="s2">&quot;path&quot;</span><span class="p">]);</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">deletepath</span><span class="p">(</span><span class="nx">pathobject</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">outlinks</span><span class="p">[</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">];</span> 

	<span class="nx">paths</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">inlinks</span><span class="p">[</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">];</span>
	<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">paths</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="nx">paths</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
			<span class="kd">var</span> <span class="nx">pathobject</span> <span class="o">=</span>  <span class="k">this</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">getById</span><span class="p">(</span><span class="nx">paths</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="s2">&quot;path&quot;</span><span class="p">]);</span> 
			<span class="k">this</span><span class="p">.</span><span class="nx">deletepath</span><span class="p">(</span><span class="nx">pathobject</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">inlinks</span><span class="p">[</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">];</span>

	<span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">];</span>
	<span class="nx">node</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>

<span class="p">}</span> <span class="c1">// end deletenode</span>

<span class="cm">/**</span>
<span class="cm">* Delete a path</span>
<span class="cm">* @methode deletepath</span>
<span class="cm">* @param path {Path} Path element to delete</span>
<span class="cm">*</span>
<span class="cm">*/</span>

<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">deletepath</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">banditLogger</span><span class="p">.</span><span class="nx">DEBUG</span><span class="p">(</span><span class="s2">&quot;Delete link &quot;</span><span class="o">+</span><span class="nx">path</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
	<span class="nx">pathid</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">node</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">outlinks</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">links</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">outlinks</span><span class="p">[</span><span class="nx">node</span><span class="p">];</span>
		<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">links</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="nx">links</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">!=</span><span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">links</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="s2">&quot;path&quot;</span><span class="p">]</span><span class="o">==</span><span class="nx">pathid</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">banditLogger</span><span class="p">.</span><span class="nx">DEBUG</span><span class="p">(</span><span class="s2">&quot;remove outlinks path &quot;</span><span class="o">+</span><span class="nx">i</span><span class="p">);</span>
				<span class="nx">links</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">node</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">inlinks</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">links</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">inlinks</span><span class="p">[</span><span class="nx">node</span><span class="p">];</span>
		<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">links</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="nx">links</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">!=</span><span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">links</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="s2">&quot;path&quot;</span><span class="p">]</span><span class="o">==</span><span class="nx">pathid</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">banditLogger</span><span class="p">.</span><span class="nx">DEBUG</span><span class="p">(</span><span class="s2">&quot;remove inlinks path &quot;</span><span class="o">+</span><span class="nx">i</span><span class="p">);</span>
				<span class="nx">links</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
        <span class="nx">arrow</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">paths</span><span class="p">[</span><span class="nx">path</span><span class="p">.</span><span class="nx">id</span><span class="p">];</span>
        <span class="nx">arrow</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
	<span class="nx">path</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>

<span class="p">}</span> <span class="c1">// end deletepath</span>

<span class="c1">// Redraw a path element</span>
<span class="cm">/**</span>
<span class="cm">* Redraw a path</span>
<span class="cm">* @methode redrawpath</span>
<span class="cm">* @param link {Path} Path element to delete</span>
<span class="cm">* @param node {int} Id of the node the path is linked as origin</span>
<span class="cm">*</span>
<span class="cm">*/</span>

<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">redrawpath</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">link</span><span class="p">,</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span><span class="p">(</span><span class="nx">link</span><span class="o">==</span><span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">// A deleted path</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="nx">path</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">getById</span><span class="p">(</span><span class="nx">link</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">]);</span>
	<span class="nx">banditLogger</span><span class="p">.</span><span class="nx">DEBUG</span><span class="p">(</span><span class="s2">&quot;path:&quot;</span> <span class="o">+</span> <span class="nx">path</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
        <span class="nx">arrow</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">paths</span><span class="p">[</span><span class="nx">path</span><span class="p">.</span><span class="nx">id</span><span class="p">][</span><span class="s2">&quot;arrow&quot;</span><span class="p">];</span>
        <span class="nx">banditLogger</span><span class="p">.</span><span class="nx">DEBUG</span><span class="p">(</span><span class="s2">&quot;arrow:&quot;</span> <span class="o">+</span> <span class="nx">arrow</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">getById</span><span class="p">(</span><span class="nx">arrow</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
	<span class="nx">remotenode</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">getById</span><span class="p">(</span><span class="nx">link</span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">]);</span>
	<span class="nx">banditLogger</span><span class="p">.</span><span class="nx">DEBUG</span><span class="p">(</span><span class="s2">&quot;remote:&quot;</span> <span class="o">+</span> <span class="nx">remotenode</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
	<span class="nx">xend</span> <span class="o">=</span> <span class="nx">remotenode</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">remotenode</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
	<span class="nx">yend</span> <span class="o">=</span> <span class="nx">remotenode</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">remotenode</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
	<span class="nx">xpos</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
	<span class="nx">ypos</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
	<span class="nx">path</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">,</span><span class="s2">&quot;M&quot;</span><span class="o">+</span><span class="nx">xpos</span><span class="o">+</span><span class="s2">&quot;,&quot;</span><span class="o">+</span><span class="nx">ypos</span><span class="o">+</span><span class="s2">&quot;L&quot;</span><span class="o">+</span><span class="nx">xend</span><span class="o">+</span><span class="s2">&quot;,&quot;</span><span class="o">+</span><span class="nx">yend</span><span class="p">);</span>
        <span class="nx">arrowdirection</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">paths</span><span class="p">[</span><span class="nx">path</span><span class="p">.</span><span class="nx">id</span><span class="p">][</span><span class="s2">&quot;direction&quot;</span><span class="p">];</span>
	<span class="k">if</span><span class="p">(</span><span class="nx">arrowdirection</span><span class="o">!=</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span> 
          <span class="nx">newarrow</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">arrow</span><span class="p">(</span><span class="nx">xpos</span><span class="p">,</span><span class="nx">ypos</span><span class="p">,</span><span class="nx">xend</span><span class="p">,</span><span class="nx">yend</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="nx">newarrow</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">arrow</span><span class="p">(</span><span class="nx">xend</span><span class="p">,</span><span class="nx">yend</span><span class="p">,</span><span class="nx">xpos</span><span class="p">,</span><span class="nx">ypos</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">paths</span><span class="p">[</span><span class="nx">path</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">arrow</span><span class="o">:</span> <span class="nx">newarrow</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">direction</span><span class="o">:</span> <span class="nx">arrowdirection</span> <span class="p">}</span> <span class="p">;</span>

<span class="p">}</span> <span class="c1">// end redrawpath</span>

<span class="cm">/**</span>
<span class="cm">* Zoom in the workflow</span>
<span class="cm">* @methode zoomIn</span>
<span class="cm">*</span>
<span class="cm">*/</span>

<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">zoomIn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">zoom</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">zoom</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
	<span class="nx">banditLogger</span><span class="p">.</span><span class="nx">DEBUG</span><span class="p">(</span><span class="s2">&quot;zoom with &quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">zoom</span><span class="p">);</span>
	<span class="nx">mybandit</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
	<span class="nx">mybandit</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">el</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
			<span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
			<span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
			<span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">({</span> <span class="nx">width</span> <span class="o">:</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">height</span><span class="o">:</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">});</span>
			<span class="nx">xpos</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
			<span class="nx">ypos</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
			<span class="nx">text</span> <span class="o">=</span> <span class="nx">mybandit</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">getById</span><span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">el</span><span class="p">.</span><span class="nx">id</span><span class="p">][</span><span class="s2">&quot;child&quot;</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">]);</span>
			<span class="nx">text</span><span class="p">.</span><span class="nx">attr</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span> <span class="nx">xpos</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">ypos</span><span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;font-size&quot;</span><span class="p">,</span><span class="nx">text</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;font-size&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
			<span class="nx">mybandit</span><span class="p">.</span><span class="nx">redrawpaths</span><span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="p">});</span>

<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm">* Zoom out the workflow</span>
<span class="cm">* @methode zoomOut</span>
<span class="cm">*</span>
<span class="cm">*/</span>

<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">zoomOut</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">this</span><span class="p">.</span><span class="nx">zoom</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">zoom</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">;</span>
	<span class="nx">banditLogger</span><span class="p">.</span><span class="nx">DEBUG</span><span class="p">(</span><span class="s2">&quot;zoom with &quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">zoom</span><span class="p">);</span>
	<span class="nx">mybandit</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
	<span class="nx">mybandit</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">el</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
			<span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">});</span>
			<span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">({</span> <span class="nx">width</span> <span class="o">:</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">,</span> <span class="nx">height</span><span class="o">:</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">});</span>
			<span class="nx">xpos</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
			<span class="nx">ypos</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
			<span class="nx">text</span> <span class="o">=</span> <span class="nx">mybandit</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">getById</span><span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">el</span><span class="p">.</span><span class="nx">id</span><span class="p">][</span><span class="s2">&quot;child&quot;</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">]);</span>
			<span class="nx">text</span><span class="p">.</span><span class="nx">attr</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span> <span class="nx">xpos</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">ypos</span><span class="p">}).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;font-size&quot;</span><span class="p">,</span><span class="nx">text</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;font-size&quot;</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="p">);</span>
			<span class="nx">mybandit</span><span class="p">.</span><span class="nx">redrawpaths</span><span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="p">});</span>

<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm">* Translate on the left the workflow</span>
<span class="cm">* @methode moveLeft</span>
<span class="cm">* @param step {int} Step of the move</span>
<span class="cm">*</span>
<span class="cm">*/</span>

<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">moveLeft</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">step</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">mybandit</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
	<span class="nx">mybandit</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">el</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
			<span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">({</span> <span class="nx">x</span><span class="o">:</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="nx">step</span> <span class="p">});</span>
			<span class="nx">xpos</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
			<span class="nx">ypos</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
			<span class="nx">mybandit</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">getById</span><span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">el</span><span class="p">.</span><span class="nx">id</span><span class="p">][</span><span class="s2">&quot;child&quot;</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">]).</span><span class="nx">attr</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span> <span class="nx">xpos</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">ypos</span><span class="p">});</span>
			<span class="nx">mybandit</span><span class="p">.</span><span class="nx">redrawpaths</span><span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="p">});</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm">* Translate on the right the workflow</span>
<span class="cm">* @methode moveRight</span>
<span class="cm">* @param step {int} Step of the move</span>
<span class="cm">*</span>
<span class="cm">*/</span>
<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">moveRight</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">step</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">mybandit</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
	<span class="nx">mybandit</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">el</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
			<span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">({</span> <span class="nx">x</span><span class="o">:</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">step</span> <span class="p">});</span>
			<span class="nx">xpos</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
			<span class="nx">ypos</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
			<span class="nx">mybandit</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">getById</span><span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">el</span><span class="p">.</span><span class="nx">id</span><span class="p">][</span><span class="s2">&quot;child&quot;</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">]).</span><span class="nx">attr</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span> <span class="nx">xpos</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">ypos</span><span class="p">});</span>
			<span class="nx">mybandit</span><span class="p">.</span><span class="nx">redrawpaths</span><span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="p">});</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm">* Translate to the up the workflow</span>
<span class="cm">* @methode moveUp</span>
<span class="cm">* @param step {int} Step of the move</span>
<span class="cm">*</span>
<span class="cm">*/</span>
<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">moveUp</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">step</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">mybandit</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
	<span class="nx">mybandit</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">el</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
			<span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">({</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="nx">step</span> <span class="p">});</span>
			<span class="nx">xpos</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
			<span class="nx">ypos</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
			<span class="nx">mybandit</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">getById</span><span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">el</span><span class="p">.</span><span class="nx">id</span><span class="p">][</span><span class="s2">&quot;child&quot;</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">]).</span><span class="nx">attr</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span> <span class="nx">xpos</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">ypos</span><span class="p">});</span>
			<span class="nx">mybandit</span><span class="p">.</span><span class="nx">redrawpaths</span><span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="p">});</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm">* Translate to the down the workflow</span>
<span class="cm">* @methode moveDown</span>
<span class="cm">* @param step {int} Step of the move</span>
<span class="cm">*</span>
<span class="cm">*/</span>
<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">moveDown</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">step</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">mybandit</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
	<span class="nx">mybandit</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">el</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
			<span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">({</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">step</span> <span class="p">});</span>
			<span class="nx">xpos</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
			<span class="nx">ypos</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
			<span class="nx">mybandit</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">getById</span><span class="p">(</span><span class="nx">mybandit</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">el</span><span class="p">.</span><span class="nx">id</span><span class="p">][</span><span class="s2">&quot;child&quot;</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">]).</span><span class="nx">attr</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span> <span class="nx">xpos</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">ypos</span><span class="p">});</span>
			<span class="nx">mybandit</span><span class="p">.</span><span class="nx">redrawpaths</span><span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="p">});</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm">* Export diagram to YAML format with all information</span>
<span class="cm">* @method export</span>
<span class="cm">* @return {String} YAML export of the workflow</span>
<span class="cm">*/</span>
<span class="nx">BandIt</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="kr">export</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">exportobject</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="nx">exportobject</span><span class="p">[</span><span class="s2">&quot;options&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="nx">exportobject</span><span class="p">[</span><span class="s2">&quot;options&quot;</span><span class="p">][</span><span class="s2">&quot;store&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">;</span>
  <span class="nx">exportobject</span><span class="p">[</span><span class="s2">&quot;workflows&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">nodes</span><span class="p">)</span>  <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="nx">banditLogger</span><span class="p">.</span><span class="nx">DEBUG</span><span class="p">(</span><span class="s2">&quot;export node &quot;</span><span class="o">+</span><span class="nx">i</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">attrs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">paper</span><span class="p">.</span><span class="nx">getById</span><span class="p">(</span><span class="nx">i</span><span class="p">).</span><span class="nx">attr</span><span class="p">();</span>
    <span class="nx">nodeprops</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">nodeprops</span><span class="p">[</span><span class="s2">&quot;graph&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">attrs</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">prop</span> <span class="k">in</span> <span class="nx">node</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">])</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">prop</span><span class="o">!=</span><span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">nodeprops</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nx">node</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="nx">prop</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">// Now manage links</span>
    <span class="kd">var</span> <span class="nx">nexts</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">outlinks</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    
    <span class="k">if</span><span class="p">(</span><span class="nx">node</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;root&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">//banditLogger.DEBUG(this.inlinks[i]);</span>
      <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">inlinks</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">==</span><span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Warning, the node &quot;</span><span class="o">+</span><span class="nx">node</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; is not linked to root node&quot;</span><span class="p">);}</span>
    <span class="p">}</span>
     
    <span class="kd">var</span> <span class="nx">next</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">nbnext</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="k">in</span> <span class="nx">nexts</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">nexts</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">nbnext</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">next</span> <span class="o">+=</span> <span class="s2">&quot;,&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">next</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">nexts</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="s2">&quot;node&quot;</span><span class="p">]][</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">];</span> 
        <span class="nx">nbnext</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">nodeprops</span><span class="p">[</span><span class="s2">&quot;next&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">next</span><span class="p">;</span>
    <span class="c1">// TODO add next elts</span>
    <span class="nx">exportobject</span><span class="p">[</span><span class="s2">&quot;workflows&quot;</span><span class="p">][</span><span class="nx">node</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">nodeprops</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nx">banditLogger</span><span class="p">.</span><span class="nx">DEBUG</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">exportobject</span><span class="p">));</span>
  <span class="c1">//console.log($.base64.encode(JSON.stringify(this.nodes)));</span>
<span class="p">}</span>



<span class="cm">/**</span>
<span class="cm">* Eval an argument.</span>
<span class="cm">* @class pick</span>
<span class="cm">* @param arg {Object} Value to test</span>
<span class="cm">* @param def {Object} Default value</span>
<span class="cm">* @return {Object} default is undefined</span>
<span class="cm">*</span>
<span class="cm">*/</span>
<span class="kd">function</span> <span class="nx">pick</span><span class="p">(</span><span class="nx">arg</span><span class="p">,</span> <span class="nx">def</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">return</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">arg</span> <span class="o">==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">?</span> <span class="nx">def</span> <span class="o">:</span> <span class="nx">arg</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm">* BanditLogger</span>
<span class="cm">* @class BanditLogger</span>
<span class="cm">* @constructor</span>
<span class="cm">* @param level {int} Level of log: 0:DEBUG, 1:INFO, 2: ERROR</span>
<span class="cm">*</span>
<span class="cm">*/</span>
<span class="kd">var</span> <span class="nx">level</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// Error</span>

<span class="kd">function</span> <span class="nx">BanditLogger</span><span class="p">(</span><span class="nx">newlevel</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">level</span> <span class="o">=</span> <span class="nx">newlevel</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm">* Log a debug level message</span>
<span class="cm">* @method DEBUG</span>
<span class="cm">* @param msg {String} message to log</span>
<span class="cm">*</span>
<span class="cm">*/</span>
<span class="nx">BanditLogger</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">DEBUG</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">level</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;#DEBUG &quot;</span><span class="o">+</span><span class="nx">date</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;: &quot;</span><span class="o">+</span><span class="nx">msg</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm">* Log an info level message</span>
<span class="cm">* @method INFO</span>
<span class="cm">* @param msg {String} message to log</span>
<span class="cm">*</span>
<span class="cm">*/</span>

<span class="nx">BanditLogger</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">INFO</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">level</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;#INFO &quot;</span><span class="o">+</span><span class="nx">date</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;: &quot;</span><span class="o">+</span><span class="nx">msg</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm">* Log an error level message</span>
<span class="cm">* @method ERROR</span>
<span class="cm">* @param msg {String} message to log</span>
<span class="cm">*</span>
<span class="cm">*/</span>

<span class="nx">BanditLogger</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">ERROR</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">level</span><span class="o">&lt;=</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;#ERROR &quot;</span><span class="o">+</span><span class="nx">date</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;: &quot;</span><span class="o">+</span><span class="nx">msg</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">banditLogger</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BanditLogger</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</pre></div>
                    </div>
			</div>
		</div>
		<div class="yui-b">
            <div class="nav">

                    <div id="moduleList" class="module">
                        <h4>Modules</h4>
                        <ul class="content">
                                <li class="selected"><a href="module_BandIt.html" title="BandIt">BandIt</a></li>
                        </ul>
                    </div>

                    <div id="classList" class="module">
                        <h4>Classes</h4>
                        <ul class="content">
                                <li class=""><a href="BandIt.html" title="BandIt">BandIt</a></li>
                                <li class=""><a href="BanditLogger.html" title="BanditLogger">BanditLogger</a></li>
                                <li class=""><a href="pick.html" title="pick">pick</a></li>
                        </ul>
                    </div>

                    <div id="fileList" class="module">
                        <h4>Files</h4>
                        <ul class="content">        
                                <li class="selected"><a href="bandit.js.html" title="bandit.js">bandit.js</a></li>
                        </ul>
                    </div>





            </div>
		</div>
	</div>
	<div id="ft">
        <hr />
        Copyright &copy; 2012 IRISA.
	</div>
</div>
<script type="text/javascript">
    ALL_YUI_PROPS = [{"url": "BandIt.html#method_addnode", "access": "", "host": "BandIt", "type": "method", "name": "addnode"}, {"url": "BanditLogger.html#method_DEBUG", "access": "", "host": "BanditLogger", "type": "method", "name": "DEBUG"}, {"url": "BandIt.html#method_deletenode", "access": "", "host": "BandIt", "type": "method", "name": "deletenode"}, {"url": "BandIt.html#method_deletepath", "access": "", "host": "BandIt", "type": "method", "name": "deletepath"}, {"url": "BanditLogger.html#method_ERROR", "access": "", "host": "BanditLogger", "type": "method", "name": "ERROR"}, {"url": "BandIt.html#method_export", "access": "", "host": "BandIt", "type": "method", "name": "export"}, {"url": "BandIt.html#method_getMode", "access": "", "host": "BandIt", "type": "method", "name": "getMode"}, {"url": "BandIt.html#method_getPaper", "access": "", "host": "BandIt", "type": "method", "name": "getPaper"}, {"url": "BanditLogger.html#method_INFO", "access": "", "host": "BanditLogger", "type": "method", "name": "INFO"}, {"url": "BandIt.html#method_link", "access": "", "host": "BandIt", "type": "method", "name": "link"}, {"url": "BandIt.html#property_mode", "access": "", "host": "BandIt", "type": "property", "name": "mode"}, {"url": "BandIt.html#method_moveDown", "access": "", "host": "BandIt", "type": "method", "name": "moveDown"}, {"url": "BandIt.html#method_moveLeft", "access": "", "host": "BandIt", "type": "method", "name": "moveLeft"}, {"url": "BandIt.html#method_moveRight", "access": "", "host": "BandIt", "type": "method", "name": "moveRight"}, {"url": "BandIt.html#method_moveUp", "access": "", "host": "BandIt", "type": "method", "name": "moveUp"}, {"url": "BandIt.html#method_redrawpath", "access": "", "host": "BandIt", "type": "method", "name": "redrawpath"}, {"url": "BandIt.html#method_redrawpaths", "access": "", "host": "BandIt", "type": "method", "name": "redrawpaths"}, {"url": "BandIt.html#method_registerAdd", "access": "", "host": "BandIt", "type": "method", "name": "registerAdd"}, {"url": "BandIt.html#method_registerDelete", "access": "", "host": "BandIt", "type": "method", "name": "registerDelete"}, {"url": "BandIt.html#method_registerSelect", "access": "", "host": "BandIt", "type": "method", "name": "registerSelect"}, {"url": "BandIt.html#method_setDefaultProperties", "access": "", "host": "BandIt", "type": "method", "name": "setDefaultProperties"}, {"url": "BandIt.html#method_setMode", "access": "", "host": "BandIt", "type": "method", "name": "setMode"}, {"url": "BandIt.html#method_setProperties", "access": "", "host": "BandIt", "type": "method", "name": "setProperties"}, {"url": "BandIt.html#method_zoomIn", "access": "", "host": "BandIt", "type": "method", "name": "zoomIn"}, {"url": "BandIt.html#method_zoomOut", "access": "", "host": "BandIt", "type": "method", "name": "zoomOut"}];
</script>
</body>
</html>

